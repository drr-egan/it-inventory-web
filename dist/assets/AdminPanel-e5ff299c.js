var se=Object.defineProperty,re=Object.defineProperties;var le=Object.getOwnPropertyDescriptors;var Z=Object.getOwnPropertySymbols;var ne=Object.prototype.hasOwnProperty,oe=Object.prototype.propertyIsEnumerable;var J=(s,o,l)=>o in s?se(s,o,{enumerable:!0,configurable:!0,writable:!0,value:l}):s[o]=l,h=(s,o)=>{for(var l in o||(o={}))ne.call(o,l)&&J(s,l,o[l]);if(Z)for(var l of Z(o))oe.call(o,l)&&J(s,l,o[l]);return s},x=(s,o)=>re(s,le(o));var w=(s,o,l)=>new Promise((R,A)=>{var j=v=>{try{g(l.next(v))}catch(F){A(F)}},E=v=>{try{g(l.throw(v))}catch(F){A(F)}},g=v=>v.done?R(v.value):Promise.resolve(v.value).then(j,E);g((l=l.apply(s,o)).next())});import{j as e,d as k}from"./index-73850ba6.js";import{r as T}from"./react-vendor-3371026b.js";import{f as $,j as M,d as _,h as L,u as ie,w as K}from"./firebase-vendor-fdbb15af.js";import{M as q}from"./MaterialCard-a87cc803.js";import{M as b}from"./MaterialButton-76fd2bde.js";import{M as S}from"./MaterialInput-22ebfbfa.js";const ue=({user:s,items:o,users:l,checkoutHistory:R,notifications:A})=>{const[j,E]=T.useState({name:"",category:"",quantity:"",price:"",minThreshold:"5"}),[g,v]=T.useState({firstName:"",lastName:"",costCode:"",department:""}),[F,O]=T.useState(!1),[V,P]=T.useState(!1),[D,U]=T.useState({importingItems:!1,importingUsers:!1,exportingItems:!1,exportingUsers:!1}),W=t=>w(void 0,null,function*(){t.preventDefault(),O(!0);try{const a={name:j.name.trim(),category:j.category||"Uncategorized",quantity:parseInt(j.quantity)||0,price:parseFloat(j.price)||0,minThreshold:parseInt(j.minThreshold)||5,createdAt:$(),lastUpdated:$(),createdBy:(s==null?void 0:s.employeeID)||(s==null?void 0:s.email)||"admin"};yield M(_(k,"items"),a),E({name:"",category:"",quantity:"",price:"",minThreshold:"5"}),alert(`Item "${a.name}" created successfully!`)}catch(a){console.error("Error creating item:",a),alert(`Failed to create item: ${a.message}`)}finally{O(!1)}}),X=t=>w(void 0,null,function*(){t.preventDefault(),P(!0);try{const a={firstName:g.firstName.trim(),lastName:g.lastName.trim(),name:`${g.firstName.trim()} ${g.lastName.trim()}`,costCode:g.costCode||`${Date.now()}-${Math.floor(Math.random()*1e3)}-5770`,department:g.department||"General",status:"active",createdAt:$(),createdBy:(s==null?void 0:s.employeeID)||(s==null?void 0:s.email)||"admin"};yield M(_(k,"users"),a),v({firstName:"",lastName:"",costCode:"",department:""}),alert(`User "${a.name}" created successfully!`)}catch(a){console.error("Error creating user:",a),alert(`Failed to create user: ${a.message}`)}finally{P(!1)}}),z=()=>w(void 0,null,function*(){U(t=>x(h({},t),{exportingItems:!0}));try{const a=[["Item Name","Category","Quantity","Price","ASIN","Min Threshold"].join(",")];o.forEach(n=>{const N=[`"${n.name||""}"`,`"${n.category||"Uncategorized"}"`,n.quantity||0,n.price||0,`"${n.asin||""}"`,n.minThreshold||5];a.push(N.join(","))});const u=a.join(`
`),c=new Blob([u],{type:"text/csv;charset=utf-8;"}),i=document.createElement("a");i.href=URL.createObjectURL(c),i.download=`inventory-items-${new Date().toISOString().split("T")[0]}.csv`,i.click(),alert(`Exported ${o.length} items to CSV`)}catch(t){alert(`Export failed: ${t.message}`)}finally{U(t=>x(h({},t),{exportingItems:!1}))}}),Y=()=>w(void 0,null,function*(){U(t=>x(h({},t),{exportingUsers:!0}));try{const a=[["EmployeeID","First Name","Last Name","Cost Code","Department","Status"].join(",")];l.forEach(n=>{const N=[`"${n.employeeID||""}"`,`"${n.firstName||""}"`,`"${n.lastName||""}"`,`"${n.costCode||n.cost_code||""}"`,`"${n.department||""}"`,`"${n.status||"active"}"`];a.push(N.join(","))});const u=a.join(`
`),c=new Blob([u],{type:"text/csv;charset=utf-8;"}),i=document.createElement("a");i.href=URL.createObjectURL(c),i.download=`inventory-users-${new Date().toISOString().split("T")[0]}.csv`,i.click(),alert(`Exported ${l.length} users to CSV`)}catch(t){alert(`Export failed: ${t.message}`)}finally{U(t=>x(h({},t),{exportingUsers:!1}))}}),H=t=>{const a=t.target.files[0];if(!a)return;U(c=>x(h({},c),{importingItems:!0}));const u=new FileReader;u.onload=c=>w(void 0,null,function*(){try{const n=c.target.result.split(`
`),N=n[0].split(",").map(f=>f.replace(/"/g,"").trim());let C=0,I=0;for(let f=1;f<n.length;f++)if(n[f].trim())try{const d=n[f].split(",").map(p=>p.replace(/"/g,"").trim()),r={};if(N.forEach((p,m)=>{switch(p.toLowerCase()){case"item name":case"name":r.name=d[m];break;case"category":r.category=d[m]||"Uncategorized";break;case"quantity":r.quantity=parseInt(d[m])||0;break;case"price":r.price=parseFloat(d[m])||0;break;case"min threshold":r.minThreshold=parseInt(d[m])||5;break;case"asin":r.asin=d[m];break}}),!r.name){I++;continue}r.createdAt=$(),r.lastUpdated=$(),r.createdBy=(s==null?void 0:s.employeeID)||(s==null?void 0:s.email)||"csv-import",yield M(_(k,"items"),r),C++}catch(d){I++,console.error("Error importing item:",d)}alert(`Import completed: ${C} items added, ${I} errors`)}catch(i){alert(`Import failed: ${i.message}`)}finally{U(i=>x(h({},i),{importingItems:!1})),t.target.value=""}}),u.readAsText(a)},ee=t=>{const a=t.target.files[0];if(!a)return;U(c=>x(h({},c),{importingUsers:!0}));const u=new FileReader;u.onload=c=>w(void 0,null,function*(){try{const n=c.target.result.split(`
`),N=n[0].split(",").map(f=>f.replace(/"/g,"").trim());let C=0,I=0;for(let f=1;f<n.length;f++)if(n[f].trim())try{const d=n[f].split(",").map(m=>m.replace(/"/g,"").trim()),r={};if(N.forEach((m,y)=>{switch(m.toLowerCase()){case"employeeid":case"employee id":case"employee_id":r.employeeID=d[y];break;case"first name":case"firstname":r.firstName=d[y];break;case"last name":case"lastname":r.lastName=d[y];break;case"cost code":case"costcode":r.costCode=d[y];break;case"department":r.department=d[y];break}}),!r.firstName||!r.lastName){I++;continue}let p=null;if(r.employeeID?p=l.find(m=>m.employeeID===r.employeeID):p=l.find(m=>!m.employeeID&&m.firstName===r.firstName&&m.lastName===r.lastName),r.name=`${r.firstName} ${r.lastName}`,r.status="active",r.costCode=r.costCode||`${Date.now()}-${Math.floor(Math.random()*1e3)}-5770`,p)if(p.firstName!==r.firstName||p.lastName!==r.lastName||p.costCode!==r.costCode||p.department!==r.department||p.employeeID!==r.employeeID){const y=L(k,"users",p.id);yield ie(y,x(h({},r),{updatedAt:$(),updatedBy:(s==null?void 0:s.employeeID)||(s==null?void 0:s.email)||"csv-import"})),C++}else continue;else r.createdAt=$(),r.createdBy=(s==null?void 0:s.employeeID)||(s==null?void 0:s.email)||"csv-import",yield M(_(k,"users"),r),C++}catch(d){I++,console.error("Error importing user:",d)}alert(`Import completed: ${C} users added, ${I} errors`)}catch(i){alert(`Import failed: ${i.message}`)}finally{U(i=>x(h({},i),{importingUsers:!1})),t.target.value=""}}),u.readAsText(a)},te=()=>w(void 0,null,function*(){if(confirm("Are you sure you want to reset ALL item quantities to zero? This cannot be undone."))try{const t=K(k);o.forEach(a=>{const u=L(k,"items",a.id);t.update(u,{quantity:0,lastUpdated:$()})}),yield t.commit(),alert(`Reset quantities for ${o.length} items`)}catch(t){alert(`Bulk reset failed: ${t.message}`)}}),ae=()=>w(void 0,null,function*(){if(confirm("Are you sure you want to remove duplicate users? This will keep the most recently updated version of each unique user."))try{const t=new Map,a=[];if(l.forEach(c=>{const i=c.employeeID||`${c.firstName}_${c.lastName}`;t.has(i)||t.set(i,[]),t.get(i).push(c)}),t.forEach((c,i)=>{if(c.length>1){const n=c.sort((N,C)=>{var d,r,p,m,y,Q,B,G;const I=((r=(d=N.updatedAt)==null?void 0:d.toDate)==null?void 0:r.call(d))||((m=(p=N.createdAt)==null?void 0:p.toDate)==null?void 0:m.call(p))||new Date(0);return(((Q=(y=C.updatedAt)==null?void 0:y.toDate)==null?void 0:Q.call(y))||((G=(B=C.createdAt)==null?void 0:B.toDate)==null?void 0:G.call(B))||new Date(0))-I});a.push(...n.slice(1))}}),a.length===0){alert("No duplicate users found.");return}const u=K(k);a.forEach(c=>{const i=L(k,"users",c.id);u.delete(i)}),yield u.commit(),alert(`Removed ${a.length} duplicate users.`)}catch(t){alert(`Failed to remove duplicates: ${t.message}`)}});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-[var(--md-sys-color-surface-container)] rounded-lg p-6 md-elevation-1",children:[e.jsxs("h2",{className:"text-2xl font-bold text-[var(--md-sys-color-on-surface)] flex items-center mb-2",children:[e.jsx("span",{className:"material-icons mr-2",children:"admin_panel_settings"}),"Administration"]}),e.jsx("p",{className:"text-sm text-[var(--md-sys-color-on-surface-variant)]",children:"Administrative tools, data management, and bulk operations"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 lg:gap-6",children:[e.jsxs(q,{elevation:2,children:[e.jsxs("h3",{className:"text-lg font-semibold text-[var(--md-sys-color-on-surface)] mb-4 flex items-center",children:[e.jsx("span",{className:"material-icons mr-2 text-blue-600",children:"add_box"}),"Add New Item"]}),e.jsxs("form",{onSubmit:W,className:"space-y-4",children:[e.jsx(S,{label:"Item Name",value:j.name,onChange:t=>E(a=>x(h({},a),{name:t.target.value})),required:!0}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(S,{label:"Price",type:"number",step:"0.01",value:j.price,onChange:t=>E(a=>x(h({},a),{price:t.target.value})),placeholder:"0.00"}),e.jsx(S,{label:"Quantity",type:"number",value:j.quantity,onChange:t=>E(a=>x(h({},a),{quantity:t.target.value})),placeholder:"0"})]}),e.jsxs("div",{className:"mat-input",children:[e.jsxs("select",{value:j.category,onChange:t=>E(a=>x(h({},a),{category:t.target.value})),className:"w-full px-3 py-2 bg-[var(--md-sys-color-surface-container-high)] text-[var(--md-sys-color-on-surface)] rounded-lg border border-[var(--md-sys-color-outline-variant)]",children:[e.jsx("option",{value:"",children:"Choose category..."}),e.jsx("option",{value:"Electronics",children:"Electronics"}),e.jsx("option",{value:"Accessories",children:"Accessories"}),e.jsx("option",{value:"Cables",children:"Cables"}),e.jsx("option",{value:"Office",children:"Office"}),e.jsx("option",{value:"Hardware",children:"Hardware"}),e.jsx("option",{value:"Software",children:"Software"}),e.jsx("option",{value:"Supplies",children:"Supplies"})]}),e.jsx("label",{className:"text-sm text-[var(--md-sys-color-on-surface-variant)]",children:"Category"})]}),e.jsx(b,{type:"submit",variant:"contained",color:"primary",className:"w-full",disabled:F,children:F?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"material-icons mr-2",children:"add"}),"Create Item"]})})]})]}),e.jsxs(q,{elevation:2,children:[e.jsxs("h3",{className:"text-lg font-semibold text-[var(--md-sys-color-on-surface)] mb-4 flex items-center",children:[e.jsx("span",{className:"material-icons mr-2 text-green-600",children:"person_add"}),"Add New User"]}),e.jsxs("form",{onSubmit:X,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(S,{label:"First Name",value:g.firstName,onChange:t=>v(a=>x(h({},a),{firstName:t.target.value})),required:!0}),e.jsx(S,{label:"Last Name",value:g.lastName,onChange:t=>v(a=>x(h({},a),{lastName:t.target.value})),required:!0})]}),e.jsx(S,{label:"Cost Code",value:g.costCode,onChange:t=>v(a=>x(h({},a),{costCode:t.target.value})),placeholder:"e.g., 1-10-100-5770 (auto-generated if empty)"}),e.jsx(S,{label:"Department",value:g.department,onChange:t=>v(a=>x(h({},a),{department:t.target.value})),placeholder:"e.g., IT, Finance, Operations"}),e.jsx(b,{type:"submit",variant:"contained",color:"success",className:"w-full",disabled:V,children:V?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"material-icons mr-2",children:"person_add"}),"Create User"]})})]})]}),e.jsxs(q,{elevation:2,children:[e.jsxs("h3",{className:"text-lg font-semibold text-[var(--md-sys-color-on-surface)] mb-4 flex items-center",children:[e.jsx("span",{className:"material-icons mr-2 text-purple-600",children:"import_export"}),"CSV Import/Export"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-[var(--md-sys-color-on-surface)] mb-2",children:"Import Data"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("input",{type:"file",accept:".csv",onChange:H,className:"hidden",id:"items-csv-import"}),e.jsx(b,{onClick:()=>document.getElementById("items-csv-import").click(),variant:"outlined",color:"primary",className:"w-full",disabled:D.importingItems,children:D.importingItems?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin mr-2"}),"Importing..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"material-icons mr-2",children:"upload_file"}),"Import Items"]})})]}),e.jsxs("div",{children:[e.jsx("input",{type:"file",accept:".csv",onChange:ee,className:"hidden",id:"users-csv-import"}),e.jsx(b,{onClick:()=>document.getElementById("users-csv-import").click(),variant:"outlined",color:"primary",className:"w-full",disabled:D.importingUsers,children:D.importingUsers?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin mr-2"}),"Importing..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"material-icons mr-2",children:"upload_file"}),"Import Users"]})})]})]})]}),e.jsxs("div",{className:"border-t border-[var(--md-sys-color-outline-variant)] pt-4",children:[e.jsx("h4",{className:"font-medium text-[var(--md-sys-color-on-surface)] mb-2",children:"Export Data"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(b,{onClick:z,variant:"outlined",color:"secondary",className:"w-full",disabled:D.exportingItems,children:D.exportingItems?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-gray-600 border-t-transparent rounded-full animate-spin mr-2"}),"Exporting..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"material-icons mr-2",children:"download"}),"Export Items (",(o==null?void 0:o.length)||0,")"]})}),e.jsx(b,{onClick:Y,variant:"outlined",color:"secondary",className:"w-full",disabled:D.exportingUsers,children:D.exportingUsers?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-gray-600 border-t-transparent rounded-full animate-spin mr-2"}),"Exporting..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"material-icons mr-2",children:"download"}),"Export Users (",(l==null?void 0:l.length)||0,")"]})})]})]}),e.jsxs("div",{className:"text-xs text-[var(--md-sys-color-on-surface-variant)] p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[e.jsx("p",{className:"font-medium mb-1",children:"📋 CSV Format Tips:"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Items:"})," Item Name, Category, Quantity, Price, ASIN, Min Threshold"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Users:"})," EmployeeID, First Name, Last Name, Cost Code, Department"]})]})]})]}),e.jsxs(q,{elevation:2,children:[e.jsxs("h3",{className:"text-lg font-semibold text-[var(--md-sys-color-on-surface)] mb-4 flex items-center",children:[e.jsx("span",{className:"material-icons mr-2 text-orange-600",children:"batch_prediction"}),"Bulk Operations"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-[var(--md-sys-color-on-surface)] mb-2",children:"Inventory Management"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(b,{onClick:z,variant:"outlined",color:"primary",className:"w-full",children:[e.jsx("span",{className:"material-icons mr-2",children:"edit"}),"Bulk Edit via CSV Export/Import"]}),e.jsxs(b,{onClick:()=>alert("Price bulk update: Export CSV, edit prices, then import back"),variant:"outlined",color:"primary",className:"w-full",children:[e.jsx("span",{className:"material-icons mr-2",children:"attach_money"}),"Update Prices via CSV"]}),e.jsxs(b,{onClick:te,variant:"outlined",color:"error",className:"w-full",children:[e.jsx("span",{className:"material-icons mr-2",children:"restore"}),"Reset All Quantities to Zero"]}),e.jsxs(b,{onClick:ae,variant:"outlined",color:"warning",className:"w-full",children:[e.jsx("span",{className:"material-icons mr-2",children:"cleaning_services"}),"Remove Duplicate Users"]})]})]}),e.jsxs("div",{className:"text-xs text-[var(--md-sys-color-on-surface-variant)] p-3 bg-amber-50 dark:bg-amber-900/20 rounded-lg",children:[e.jsx("p",{className:"font-medium mb-1",children:"⚠️ Bulk Operations:"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Edit/Prices:"})," Use CSV export → edit → import workflow"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Reset:"})," Sets ALL item quantities to zero (permanent!)"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Duplicates:"})," Removes duplicate users by employeeID (keeps most recent)"]})]})]})]}),e.jsxs(q,{elevation:2,className:"lg:col-span-2",children:[e.jsxs("h3",{className:"text-lg font-semibold text-[var(--md-sys-color-on-surface)] mb-4 flex items-center",children:[e.jsx("span",{className:"material-icons mr-2 text-indigo-600",children:"analytics"}),"System Statistics"]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:(o==null?void 0:o.length)||0}),e.jsx("div",{className:"text-sm text-[var(--md-sys-color-on-surface-variant)]",children:"Total Items"})]}),e.jsxs("div",{className:"text-center p-4 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:[(l==null?void 0:l.length)||0,"+"]}),e.jsx("div",{className:"text-sm text-[var(--md-sys-color-on-surface-variant)]",children:"Active Users"})]}),e.jsxs("div",{className:"text-center p-4 bg-purple-50 dark:bg-purple-900/20 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:(R==null?void 0:R.length)||0}),e.jsx("div",{className:"text-sm text-[var(--md-sys-color-on-surface-variant)]",children:"Recent Checkouts"})]}),e.jsxs("div",{className:"text-center p-4 bg-amber-50 dark:bg-amber-900/20 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-amber-600 dark:text-amber-400",children:(A==null?void 0:A.length)||0}),e.jsx("div",{className:"text-sm text-[var(--md-sys-color-on-surface-variant)]",children:"Low Stock Alerts"})]})]})]})]})]})};export{ue as default};
