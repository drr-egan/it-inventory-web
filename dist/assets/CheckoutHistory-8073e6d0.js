var H=Object.defineProperty;var g=Object.getOwnPropertySymbols;var $=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable;var b=(c,t,r)=>t in c?H(c,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[t]=r,u=(c,t)=>{for(var r in t||(t={}))$.call(t,r)&&b(c,r,t[r]);if(g)for(var r of g(t))I.call(t,r)&&b(c,r,t[r]);return c};import{j as e,L as U,d as w}from"./index-bf4d9d0b.js";import{r as i}from"./react-vendor-3371026b.js";import{q as k,l as C,c as S,d as D,e as L}from"./firebase-vendor-aa9b84e9.js";const B=({user:c})=>{const[t,r]=i.useState([]),[h,E]=i.useState([]),[n,v]=i.useState("current"),[q,p]=i.useState(!0),[f,A]=i.useState(null),[l,y]=i.useState("");i.useEffect(()=>{const s=k(D(w,"checkoutHistory"),S("dateEntered","desc"),C(500)),o=L(s,a=>{const x=a.docs.map(d=>u({id:d.id},d.data()));r(x),p(!1)},a=>{console.error("Error fetching checkout history:",a),A("Failed to load checkout history"),p(!1)});return()=>o()},[]),i.useEffect(()=>{const s=k(D(w,"archivedCheckouts"),S("archivedAt","desc"),C(500)),o=L(s,a=>{const x=a.docs.map(d=>u({id:d.id},d.data()));E(x)},a=>{console.error("Error fetching archived checkouts:",a)});return()=>o()},[]);const j=n==="current"?t:h,m=j.filter(s=>{var a;if(!l)return!0;const o=l.toLowerCase();return(s.itemName||s.item||"").toLowerCase().includes(o)||(s.userName||s.user||"").toLowerCase().includes(o)||(s.departmentId||s.costCode||"").toLowerCase().includes(o)||(((a=s.quantity)==null?void 0:a.toString())||"").includes(o)}),N=s=>s?s.toDate?s.toDate().toLocaleDateString():typeof s=="string"?new Date(s).toLocaleDateString():"Unknown":"Unknown";return q?e.jsxs("div",{className:"flex items-center justify-center h-64",children:[e.jsx(U,{size:"large"}),e.jsx("span",{className:"ml-4 text-[var(--md-sys-color-on-surface)]",children:"Loading history..."})]}):f?e.jsx("div",{className:"bg-[var(--md-sys-color-error-container)] border border-[var(--md-sys-color-error)] rounded-md p-4",children:e.jsx("p",{className:"text-[var(--md-sys-color-on-error-container)]",children:f})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-[var(--md-sys-color-surface-container)] rounded-lg p-6 md-elevation-1",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-[var(--md-sys-color-on-surface)] flex items-center",children:[e.jsx("span",{className:"material-icons mr-2",children:"history"}),"Checkout History"]}),e.jsx("p",{className:"text-sm text-[var(--md-sys-color-on-surface-variant)] mt-1",children:n==="current"?"View active checkout records awaiting processing":"View processed and archived checkout records"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>v("current"),className:`px-4 py-2 rounded-full flex items-center gap-2 transition-all ${n==="current"?"bg-[var(--md-sys-color-primary)] text-[var(--md-sys-color-on-primary)] md-elevation-2":"bg-[var(--md-sys-color-surface-container-high)] text-[var(--md-sys-color-on-surface-variant)]"}`,children:[e.jsx("span",{className:"material-icons text-sm",children:"pending_actions"}),"Current",e.jsx("span",{className:"bg-white/20 px-2 py-0.5 rounded-full text-xs font-bold",children:t.length})]}),e.jsxs("button",{onClick:()=>v("archive"),className:`px-4 py-2 rounded-full flex items-center gap-2 transition-all ${n==="archive"?"bg-[var(--md-sys-color-primary)] text-[var(--md-sys-color-on-primary)] md-elevation-2":"bg-[var(--md-sys-color-surface-container-high)] text-[var(--md-sys-color-on-surface-variant)]"}`,children:[e.jsx("span",{className:"material-icons text-sm",children:"inventory"}),"Archive",e.jsx("span",{className:"bg-white/20 px-2 py-0.5 rounded-full text-xs font-bold",children:h.length})]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"material-icons absolute left-3 top-1/2 -translate-y-1/2 text-[var(--md-sys-color-on-surface-variant)]",children:"search"}),e.jsx("input",{type:"text",placeholder:"Search by item, user, department, or quantity...",value:l,onChange:s=>y(s.target.value),className:"w-full pl-10 pr-4 py-2 bg-[var(--md-sys-color-surface-container-high)] text-[var(--md-sys-color-on-surface)] rounded-lg border border-[var(--md-sys-color-outline-variant)] focus:outline-none focus:ring-2 focus:ring-[var(--md-sys-color-primary)]"}),l&&e.jsx("button",{onClick:()=>y(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-[var(--md-sys-color-on-surface-variant)] hover:text-[var(--md-sys-color-on-surface)]",children:e.jsx("span",{className:"material-icons text-sm",children:"close"})})]}),l&&e.jsxs("p",{className:"text-sm text-[var(--md-sys-color-on-surface-variant)]",children:["Found ",m.length," of ",j.length," records"]})]})}),e.jsx("div",{className:"bg-[var(--md-sys-color-surface-container)] rounded-lg md-elevation-1 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{className:"bg-[var(--md-sys-color-surface-container-high)]",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-[var(--md-sys-color-on-surface-variant)] uppercase",children:"Item"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-[var(--md-sys-color-on-surface-variant)] uppercase",children:"User"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-[var(--md-sys-color-on-surface-variant)] uppercase",children:"Quantity"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-[var(--md-sys-color-on-surface-variant)] uppercase",children:"Department"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-[var(--md-sys-color-on-surface-variant)] uppercase",children:"Date"}),n==="archive"&&e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-[var(--md-sys-color-on-surface-variant)] uppercase",children:"Archived Date"})]})}),e.jsx("tbody",{className:"divide-y divide-[var(--md-sys-color-outline-variant)]",children:m.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:n==="archive"?6:5,className:"px-6 py-8 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("span",{className:"material-icons text-4xl text-[var(--md-sys-color-on-surface-variant)]",children:"inbox"}),e.jsx("p",{className:"text-[var(--md-sys-color-on-surface-variant)]",children:l?`No records matching "${l}"`:`No ${n==="archive"?"archived":"current"} records found`})]})})}):m.map(s=>e.jsxs("tr",{className:"hover:bg-[var(--md-sys-color-surface-container-highest)] transition-colors",children:[e.jsx("td",{className:"px-6 py-4 font-medium text-[var(--md-sys-color-on-surface)]",children:s.itemName||s.item}),e.jsx("td",{className:"px-6 py-4 text-[var(--md-sys-color-on-surface-variant)]",children:s.userName||s.user}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-[var(--md-sys-color-primary-container)] text-[var(--md-sys-color-on-primary-container)]",children:s.quantity})}),e.jsx("td",{className:"px-6 py-4 text-sm text-[var(--md-sys-color-on-surface-variant)]",children:s.departmentId||s.costCode||"-"}),e.jsx("td",{className:"px-6 py-4 text-sm text-[var(--md-sys-color-on-surface-variant)]",children:N(s.dateEntered||s.date)}),n==="archive"&&e.jsx("td",{className:"px-6 py-4 text-sm text-[var(--md-sys-color-on-surface-variant)]",children:N(s.archivedAt)})]},s.id))})]})})})]})};export{B as default};
