var L=Object.defineProperty;var y=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var j=(a,t,r)=>t in a?L(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,m=(a,t)=>{for(var r in t||(t={}))q.call(t,r)&&j(a,r,t[r]);if(y)for(var r of y(t))A.call(t,r)&&j(a,r,t[r]);return a};import{j as e,L as H,d as N}from"./index-c582cf04.js";import{r as o}from"./react-vendor-3371026b.js";import{q as g,l as b,c as k,d as w,e as C}from"./firebase-vendor-7cc9ba84.js";const $=({user:a})=>{const[t,r]=o.useState([]),[x,D]=o.useState([]),[c,u]=o.useState("current"),[S,h]=o.useState(!0),[p,E]=o.useState(null);o.useEffect(()=>{const s=g(w(N,"checkoutHistory"),k("dateEntered","desc"),b(500)),l=C(s,n=>{const d=n.docs.map(i=>m({id:i.id},i.data()));r(d),h(!1)},n=>{console.error("Error fetching checkout history:",n),E("Failed to load checkout history"),h(!1)});return()=>l()},[]),o.useEffect(()=>{const s=g(w(N,"archivedCheckouts"),k("archivedAt","desc"),b(500)),l=C(s,n=>{const d=n.docs.map(i=>m({id:i.id},i.data()));D(d)},n=>{console.error("Error fetching archived checkouts:",n)});return()=>l()},[]);const v=c==="current"?t:x,f=s=>s?s.toDate?s.toDate().toLocaleDateString():typeof s=="string"?new Date(s).toLocaleDateString():"Unknown":"Unknown";return S?e.jsxs("div",{className:"flex items-center justify-center h-64",children:[e.jsx(H,{size:"large"}),e.jsx("span",{className:"ml-4 text-[var(--md-sys-color-on-surface)]",children:"Loading history..."})]}):p?e.jsx("div",{className:"bg-[var(--md-sys-color-error-container)] border border-[var(--md-sys-color-error)] rounded-md p-4",children:e.jsx("p",{className:"text-[var(--md-sys-color-on-error-container)]",children:p})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-[var(--md-sys-color-surface-container)] rounded-lg p-6 md-elevation-1",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-[var(--md-sys-color-on-surface)] flex items-center",children:[e.jsx("span",{className:"material-icons mr-2",children:"history"}),"Checkout History"]}),e.jsx("p",{className:"text-sm text-[var(--md-sys-color-on-surface-variant)] mt-1",children:c==="current"?"View active checkout records awaiting processing":"View processed and archived checkout records"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>u("current"),className:`px-4 py-2 rounded-full flex items-center gap-2 transition-all ${c==="current"?"bg-[var(--md-sys-color-primary)] text-[var(--md-sys-color-on-primary)] md-elevation-2":"bg-[var(--md-sys-color-surface-container-high)] text-[var(--md-sys-color-on-surface-variant)]"}`,children:[e.jsx("span",{className:"material-icons text-sm",children:"pending_actions"}),"Current",e.jsx("span",{className:"bg-white/20 px-2 py-0.5 rounded-full text-xs font-bold",children:t.length})]}),e.jsxs("button",{onClick:()=>u("archive"),className:`px-4 py-2 rounded-full flex items-center gap-2 transition-all ${c==="archive"?"bg-[var(--md-sys-color-primary)] text-[var(--md-sys-color-on-primary)] md-elevation-2":"bg-[var(--md-sys-color-surface-container-high)] text-[var(--md-sys-color-on-surface-variant)]"}`,children:[e.jsx("span",{className:"material-icons text-sm",children:"inventory"}),"Archive",e.jsx("span",{className:"bg-white/20 px-2 py-0.5 rounded-full text-xs font-bold",children:x.length})]})]})]})}),e.jsx("div",{className:"bg-[var(--md-sys-color-surface-container)] rounded-lg md-elevation-1 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{className:"bg-[var(--md-sys-color-surface-container-high)]",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-[var(--md-sys-color-on-surface-variant)] uppercase",children:"Item"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-[var(--md-sys-color-on-surface-variant)] uppercase",children:"User"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-[var(--md-sys-color-on-surface-variant)] uppercase",children:"Quantity"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-[var(--md-sys-color-on-surface-variant)] uppercase",children:"Department"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-[var(--md-sys-color-on-surface-variant)] uppercase",children:"Date"}),c==="archive"&&e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-[var(--md-sys-color-on-surface-variant)] uppercase",children:"Archived Date"})]})}),e.jsx("tbody",{className:"divide-y divide-[var(--md-sys-color-outline-variant)]",children:v.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:c==="archive"?6:5,className:"px-6 py-8 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("span",{className:"material-icons text-4xl text-[var(--md-sys-color-on-surface-variant)]",children:"inbox"}),e.jsxs("p",{className:"text-[var(--md-sys-color-on-surface-variant)]",children:["No ",c==="archive"?"archived":"current"," records found"]})]})})}):v.map(s=>e.jsxs("tr",{className:"hover:bg-[var(--md-sys-color-surface-container-highest)] transition-colors",children:[e.jsx("td",{className:"px-6 py-4 font-medium text-[var(--md-sys-color-on-surface)]",children:s.itemName||s.item}),e.jsx("td",{className:"px-6 py-4 text-[var(--md-sys-color-on-surface-variant)]",children:s.userName||s.user}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-[var(--md-sys-color-primary-container)] text-[var(--md-sys-color-on-primary-container)]",children:s.quantity})}),e.jsx("td",{className:"px-6 py-4 text-sm text-[var(--md-sys-color-on-surface-variant)]",children:s.departmentId||s.costCode||"-"}),e.jsx("td",{className:"px-6 py-4 text-sm text-[var(--md-sys-color-on-surface-variant)]",children:f(s.dateEntered||s.date)}),c==="archive"&&e.jsx("td",{className:"px-6 py-4 text-sm text-[var(--md-sys-color-on-surface-variant)]",children:f(s.archivedAt)})]},s.id))})]})})})]})};export{$ as default};
