var pe=Object.defineProperty,ye=Object.defineProperties;var je=Object.getOwnPropertyDescriptors;var D=Object.getOwnPropertySymbols;var te=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable;var ee=(c,r,i)=>r in c?pe(c,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):c[r]=i,m=(c,r)=>{for(var i in r||(r={}))te.call(r,i)&&ee(c,i,r[i]);if(D)for(var i of D(r))ae.call(r,i)&&ee(c,i,r[i]);return c},p=(c,r)=>ye(c,je(r));var se=(c,r)=>{var i={};for(var x in c)te.call(c,x)&&r.indexOf(x)<0&&(i[x]=c[x]);if(c!=null&&D)for(var x of D(c))r.indexOf(x)<0&&ae.call(c,x)&&(i[x]=c[x]);return i};var B=(c,r,i)=>new Promise((x,N)=>{var u=g=>{try{b(i.next(g))}catch(k){N(k)}},q=g=>{try{b(i.throw(g))}catch(k){N(k)}},b=g=>g.done?x(g.value):Promise.resolve(g.value).then(u,q);b((i=i.apply(c,r)).next())});import{j as t,L as be,d as E}from"./index-bf4d9d0b.js";import{r as d}from"./react-vendor-3371026b.js";import{q as fe,c as ve,d as re,e as Ne,f as Q,u as U,h as _,j as ke}from"./firebase-vendor-aa9b84e9.js";import{M as P,a as j,b as we}from"./MaterialPagination-0584cee3.js";const v=d.forwardRef((b,q)=>{var g=b,{label:c,type:r="text",value:i,onChange:x,placeholder:N=" "}=g,u=se(g,["label","type","value","onChange","placeholder"]);return t.jsxs("div",{className:"mat-input",children:[t.jsx("input",m({ref:q,type:r,value:i,onChange:x,placeholder:N},u)),t.jsx("label",{children:c})]})});v.displayName="MaterialInput";const Ae=({user:c})=>{const[r,i]=d.useState([]),[x,N]=d.useState(!0),[u,q]=d.useState("edit"),[b,g]=d.useState(""),[k,ne]=d.useState("all"),[S,z]=d.useState({}),[f,F]=d.useState(""),[V,ie]=d.useState([]),[C,M]=d.useState({currentPage:1,itemsPerPage:50,totalItems:0}),[l,I]=d.useState({name:"",price:"",quantity:"",category:"",asin:""}),[Z,K]=d.useState(!1),[y,A]=d.useState(new Set),[h,O]=d.useState(""),[$,H]=d.useState(""),[G,J]=d.useState(!1),R=d.useRef(null);d.useEffect(()=>{const e=fe(re(E,"items"),ve("name")),a=Ne(e,s=>{const n=s.docs.map(o=>m({id:o.id},o.data()));i(n),N(!1)},s=>{console.error("Error fetching items:",s),N(!1)});return()=>a()},[]);const W=["all",...new Set(r.map(e=>e.category||"Uncategorized").filter(Boolean))],T=r.filter(e=>{var n,o;const a=((n=e.name)==null?void 0:n.toLowerCase().includes(b.toLowerCase()))||((o=e.asin)==null?void 0:o.toLowerCase().includes(b.toLowerCase())),s=k==="all"||e.category===k;return a&&s});d.useEffect(()=>{M(e=>p(m({},e),{totalItems:T.length}))},[T.length]);const L=()=>{const e=(C.currentPage-1)*C.itemsPerPage,a=e+C.itemsPerPage;return T.slice(e,a)},ce=e=>{M(a=>p(m({},a),{currentPage:e}))},le=e=>{M(a=>p(m({},a),{itemsPerPage:e,currentPage:1}))},X=(e,a,s)=>{z(n=>p(m({},n),{[e]:p(m({},n[e]),{[a]:s})}))},oe=e=>B(void 0,null,function*(){const a=S[e];if(a)try{const s={};a.quantity!==void 0&&(s.quantity=parseInt(a.quantity)),a.price!==void 0&&(s.price=parseFloat(a.price)),s.lastUpdated=Q(),yield U(_(E,"items",e),s),z(n=>{const o=m({},n);return delete o[e],o})}catch(s){console.error("Error updating item:",s),alert(`Failed to update item: ${s.message}`)}}),Y=()=>B(void 0,null,function*(){if(f.trim())try{const e=f.toLowerCase().trim(),a=r.find(s=>s.asin===f||s.id===f||s.name.toLowerCase()===e||s.name.toLowerCase().includes(e));if(!a){alert(`Item not found: ${f}`);return}yield U(_(E,"items",a.id),{quantity:(a.quantity||0)+1,lastUpdated:Q()}),ie(s=>[{id:Date.now(),item:a,timestamp:new Date},...s.slice(0,4)]),F(""),R.current&&R.current.focus()}catch(e){console.error("Scan error:",e),alert(`Scan failed: ${e.message}`)}}),de=e=>{e.key==="Enter"&&f.trim()&&(e.preventDefault(),Y())},me=()=>B(void 0,null,function*(){if(!l.name.trim()){alert("Item name is required");return}K(!0);try{yield ke(re(E,"items"),{name:l.name.trim(),price:l.price?parseFloat(l.price):0,quantity:l.quantity?parseInt(l.quantity):0,category:l.category||"Uncategorized",asin:l.asin||"",minThreshold:5,createdAt:Q(),lastUpdated:Q()}),I({name:"",price:"",quantity:"",category:"",asin:""}),alert("Item created successfully!")}catch(e){console.error("Error creating item:",e),alert(`Failed to create item: ${e.message}`)}finally{K(!1)}}),xe=()=>{const e=`Item,Current Quantity,New Quantity,Price,ASIN,Category
`,a=r.map(w=>`"${w.name}",${w.quantity||0},,${w.price||""},${w.asin||""},${w.category||""}`).join(`
`),s=new Blob([e+a],{type:"text/csv"}),n=window.URL.createObjectURL(s),o=document.createElement("a");o.href=n,o.download=`inventory-export-${new Date().toISOString().split("T")[0]}.csv`,o.click()},ue=e=>{A(a=>{const s=new Set(a);return s.has(e)?s.delete(e):s.add(e),s})},ge=()=>{y.size===L().length?A(new Set):A(new Set(L().map(e=>e.id)))},he=()=>B(void 0,null,function*(){if(y.size===0){alert("Please select items to perform bulk action");return}if(!h){alert("Please select a bulk action");return}if((h==="setQuantity"||h==="setPrice")&&!$){alert("Please enter a value");return}const e=`Are you sure you want to ${h} for ${y.size} items?`;if(confirm(e)){J(!0);try{const a=[];for(const s of y){const n={lastUpdated:Q()};switch(h){case"setQuantity":n.quantity=parseInt($);break;case"setPrice":n.price=parseFloat($);break;case"setZero":n.quantity=0;break;case"incrementQuantity":const o=r.find(w=>w.id===s);n.quantity=((o==null?void 0:o.quantity)||0)+(parseInt($)||1);break}a.push(U(_(E,"items",s),n))}yield Promise.all(a),A(new Set),O(""),H(""),alert(`Bulk action completed for ${y.size} items!`)}catch(a){console.error("Bulk action error:",a),alert(`Bulk action failed: ${a.message}`)}finally{J(!1)}}});return x?t.jsxs("div",{className:"flex items-center justify-center h-64",children:[t.jsx(be,{size:"large"}),t.jsx("span",{className:"ml-4 dark:text-gray-300",children:"Loading inventory..."})]}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs(P,{elevation:2,children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{children:[t.jsxs("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white flex items-center",children:[t.jsx("span",{className:"material-icons mr-2",children:"inventory_2"}),"Inventory Management"]}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:u==="edit"?"Direct editing and bulk operations":"Rapid inventory counting"})]}),t.jsxs(j,{variant:"contained",color:u==="scan"?"success":"primary",onClick:()=>q(u==="edit"?"scan":"edit"),children:[t.jsx("span",{className:"material-icons mr-2",children:u==="scan"?"edit":"qr_code_scanner"}),"Switch to ",u==="edit"?"Scan":"Edit"," Mode"]})]}),u==="edit"&&t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs(j,{variant:"outlined",color:"primary",onClick:xe,children:[t.jsx("span",{className:"material-icons mr-2",children:"download"}),"Export Template"]}),t.jsxs(j,{variant:"outlined",color:"primary",children:[t.jsx("span",{className:"material-icons mr-2",children:"upload"}),"Import CSV"]})]})]}),u==="scan"&&t.jsxs(P,{elevation:1,children:[t.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4 flex items-center",children:[t.jsx("span",{className:"material-icons mr-2 text-green-600",children:"qr_code_scanner"}),"Barcode Scanner"]}),t.jsxs("div",{className:"flex gap-4 mb-4",children:[t.jsx(v,{ref:R,label:"Scan barcode or type item name",value:f,onChange:e=>F(e.target.value),onKeyDown:de,autoFocus:!0,placeholder:"Enter item name, ASIN, or scan barcode..."}),t.jsxs(j,{onClick:Y,disabled:!f.trim(),variant:"contained",color:"success",className:"!px-8",children:[t.jsx("span",{className:"material-icons mr-2",children:"search"}),"Scan"]})]}),V.length>0&&t.jsxs("div",{className:"mt-4",children:[t.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-2",children:"Recent Scans"}),t.jsx("div",{className:"space-y-2",children:V.map(e=>t.jsxs("div",{className:"flex justify-between items-center p-3 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:e.item.name}),t.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.timestamp.toLocaleTimeString()})]}),t.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"âœ¨ +1"})]},e.id))})]})]}),u==="edit"&&t.jsxs(t.Fragment,{children:[t.jsxs(P,{elevation:1,children:[t.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4 flex items-center",children:[t.jsx("span",{className:"material-icons mr-2 text-blue-600",children:"add_box"}),"Add New Item"]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsx(v,{label:"Item Name *",value:l.name,onChange:e=>I(p(m({},l),{name:e.target.value}))}),t.jsx(v,{label:"Price",type:"number",value:l.price,onChange:e=>I(p(m({},l),{price:e.target.value}))}),t.jsx(v,{label:"Initial Quantity",type:"number",value:l.quantity,onChange:e=>I(p(m({},l),{quantity:e.target.value}))}),t.jsx(v,{label:"ASIN",value:l.asin,onChange:e=>I(p(m({},l),{asin:e.target.value}))}),t.jsxs("select",{value:l.category,onChange:e=>I(p(m({},l),{category:e.target.value})),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[t.jsx("option",{value:"",children:"Select Category"}),W.filter(e=>e!=="all").map(e=>t.jsx("option",{value:e,children:e},e))]}),t.jsxs(j,{onClick:me,disabled:Z||!l.name.trim(),variant:"contained",color:"success",children:[t.jsx("span",{className:"material-icons mr-2",children:"add"}),Z?"Creating...":"Create Item"]})]})]}),t.jsx(P,{elevation:1,children:t.jsxs("div",{className:"flex gap-4",children:[t.jsx(v,{label:"Search items",value:b,onChange:e=>g(e.target.value),placeholder:"Search by name or ASIN..."}),t.jsx("select",{value:k,onChange:e=>ne(e.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:W.map(e=>t.jsx("option",{value:e,children:e==="all"?"All Categories":e},e))})]})}),y.size>0&&t.jsxs(P,{elevation:2,className:"!bg-blue-50 dark:!bg-blue-900/20 !border !border-blue-200 dark:!border-blue-800",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{children:[t.jsxs("h3",{className:"text-lg font-medium text-gray-900 dark:text-white flex items-center",children:[t.jsx("span",{className:"material-icons mr-2 text-blue-600",children:"check_circle"}),"Bulk Actions"]}),t.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[y.size," item",y.size!==1?"s":""," selected"]})]}),t.jsx(j,{onClick:()=>A(new Set),variant:"text",color:"secondary",children:"Clear Selection"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs("select",{value:h,onChange:e=>O(e.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[t.jsx("option",{value:"",children:"Select Action"}),t.jsx("option",{value:"setQuantity",children:"Set Quantity"}),t.jsx("option",{value:"setPrice",children:"Set Price"}),t.jsx("option",{value:"incrementQuantity",children:"Increment Quantity"}),t.jsx("option",{value:"setZero",children:"Set All to Zero"})]}),(h==="setQuantity"||h==="setPrice"||h==="incrementQuantity")&&t.jsx(v,{label:h==="setPrice"?"Price":"Quantity",type:"number",step:h==="setPrice"?"0.01":"1",value:$,onChange:e=>H(e.target.value)}),t.jsxs(j,{onClick:he,disabled:G||!h,variant:"contained",color:"primary",className:"md:col-span-2",children:[t.jsx("span",{className:"material-icons mr-2",children:"done_all"}),G?"Processing...":"Apply to Selected"]})]})]}),t.jsxs(P,{elevation:1,children:[t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full",children:[t.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left",children:t.jsx("input",{type:"checkbox",checked:y.size===L().length&&L().length>0,onChange:ge,className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"})}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Item"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Quantity"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Price"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Category"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Actions"})]})}),t.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:L().map(e=>{var a,s;return t.jsxs("tr",{className:`hover:bg-gray-50 dark:hover:bg-gray-700 ${y.has(e.id)?"bg-blue-50 dark:bg-blue-900/20":""}`,children:[t.jsx("td",{className:"px-6 py-4",children:t.jsx("input",{type:"checkbox",checked:y.has(e.id),onChange:()=>ue(e.id),className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"})}),t.jsxs("td",{className:"px-6 py-4",children:[t.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:e.name}),e.asin&&t.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.asin})]}),t.jsx("td",{className:"px-6 py-4",children:S[e.id]?t.jsx("input",{type:"number",value:(a=S[e.id].quantity)!=null?a:e.quantity,onChange:n=>X(e.id,"quantity",n.target.value),className:"w-20 px-2 py-1 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}):t.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${e.quantity<=(e.minThreshold||5)?"bg-red-100 dark:bg-red-900/20 text-red-700 dark:text-red-300":"bg-green-100 dark:bg-green-900/20 text-green-700 dark:text-green-300"}`,children:e.quantity||0})}),t.jsx("td",{className:"px-6 py-4",children:S[e.id]?t.jsx("input",{type:"number",step:"0.01",value:(s=S[e.id].price)!=null?s:e.price,onChange:n=>X(e.id,"price",n.target.value),className:"w-24 px-2 py-1 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}):e.price>0?t.jsxs("span",{className:"text-green-600 dark:text-green-400 font-medium",children:["$",e.price]}):t.jsx("span",{className:"text-gray-400",children:"-"})}),t.jsx("td",{className:"px-6 py-4 text-sm text-gray-600 dark:text-gray-400",children:e.category||"Uncategorized"}),t.jsx("td",{className:"px-6 py-4",children:S[e.id]?t.jsxs("div",{className:"flex gap-2",children:[t.jsx(j,{onClick:()=>oe(e.id),variant:"text",color:"success",className:"!p-2 !min-w-0",children:t.jsx("span",{className:"material-icons text-sm",children:"save"})}),t.jsx(j,{onClick:()=>z(n=>{const o=m({},n);return delete o[e.id],o}),variant:"text",color:"error",className:"!p-2 !min-w-0",children:t.jsx("span",{className:"material-icons text-sm",children:"close"})})]}):t.jsx(j,{onClick:()=>z(n=>p(m({},n),{[e.id]:{quantity:e.quantity,price:e.price}})),variant:"text",color:"primary",className:"!p-2 !min-w-0",children:t.jsx("span",{className:"material-icons text-sm",children:"edit"})})})]},e.id)})})]})}),t.jsx(we,{currentPage:C.currentPage,totalItems:C.totalItems,itemsPerPage:C.itemsPerPage,onPageChange:ce,onItemsPerPageChange:le})]})]})]})};export{Ae as default};
