var F=Object.defineProperty,R=Object.defineProperties;var T=Object.getOwnPropertyDescriptors;var N=Object.getOwnPropertySymbols;var $=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var k=(r,a,t)=>a in r?F(r,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[a]=t,d=(r,a)=>{for(var t in a||(a={}))$.call(a,t)&&k(r,t,a[t]);if(N)for(var t of N(a))O.call(a,t)&&k(r,t,a[t]);return r},x=(r,a)=>R(r,T(a));import{j as e,L as G,d as v}from"./index-bf03f64d.js";import{r as l}from"./react-vendor-3371026b.js";import{q as P,c as w,d as S,e as C}from"./firebase-vendor-3599879c.js";import{M as H,a as J}from"./MaterialButton-ca0e42f1.js";import{M as K}from"./MaterialPagination-e7729cb7.js";import V from"./ShoppingCart-e7c95804.js";const te=({user:r,cart:a,addToCart:t,removeFromCart:I,clearCart:q})=>{const[f,E]=l.useState([]),[L,M]=l.useState([]),[U,j]=l.useState(!0),[b,_]=l.useState(""),[h,z]=l.useState("all"),[i,u]=l.useState({currentPage:1,itemsPerPage:50,totalItems:0});l.useEffect(()=>{const s=P(S(v,"items"),w("name")),n=C(s,c=>{const y=c.docs.map(o=>d({id:o.id},o.data()));E(y),j(!1)},c=>{console.error("Error fetching items:",c),j(!1)}),p=P(S(v,"users"),w("firstName")),g=C(p,c=>{const y=c.docs.map(o=>d({id:o.id},o.data()));M(y)},c=>{console.error("Error fetching users:",c)});return()=>{n(),g()}},[]);const B=["all",...new Set(f.map(s=>s.category||"Uncategorized"))],m=f.filter(s=>{var g;const n=(g=s.name)==null?void 0:g.toLowerCase().includes(b.toLowerCase()),p=h==="all"||s.category===h;return n&&p&&(s.quantity||0)>0});l.useEffect(()=>{u(s=>x(d({},s),{totalItems:m.length}))},[m.length]);const Q=()=>{const s=(i.currentPage-1)*i.itemsPerPage,n=s+i.itemsPerPage;return m.slice(s,n)},A=s=>{u(n=>x(d({},n),{currentPage:s}))},D=s=>{u(n=>x(d({},n),{itemsPerPage:s,currentPage:1}))};return U?e.jsxs("div",{className:"flex items-center justify-center h-64",children:[e.jsx(G,{size:"large"}),e.jsx("span",{className:"ml-4 dark:text-gray-300",children:"Loading shop..."})]}):e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-4 lg:gap-6",children:[e.jsxs("div",{className:"xl:col-span-2 space-y-4 lg:space-y-6 order-2 xl:order-1",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 shadow-md",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"material-icons text-xl mr-2 text-blue-600",children:"qr_code_scanner"}),e.jsx("h3",{className:"text-lg font-medium dark:text-white",children:"Barcode Scanner"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Ready"})]})]}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Quick add items to cart by scanning barcodes or typing item names"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-md",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white flex items-center mb-4",children:[e.jsx("span",{className:"material-icons mr-2",children:"storefront"}),"Shop Items"]}),e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsx("input",{type:"text",placeholder:"Search items...",value:b,onChange:s=>_(s.target.value),className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500"}),e.jsx("select",{value:h,onChange:s=>z(s.target.value),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500",children:B.map(s=>e.jsx("option",{value:s,children:s==="all"?"All Categories":s},s))})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 2xl:grid-cols-4 gap-3 lg:gap-4",children:Q().map(s=>e.jsxs(H,{elevation:1,className:"!p-3 lg:!p-4 hover:mat-elevation-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("h3",{className:"font-medium text-sm text-gray-900 dark:text-white line-clamp-2",children:s.name}),e.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${s.quantity<=(s.minThreshold||5)?"bg-red-100 dark:bg-red-900/20 text-red-700 dark:text-red-300":"bg-green-100 dark:bg-green-900/20 text-green-700 dark:text-green-300"}`,children:s.quantity})]}),e.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"material-icons text-xs mr-1",children:"category"}),s.category||"Uncategorized"]}),s.price>0&&e.jsxs("div",{className:"flex items-center mt-1 text-green-600 dark:text-green-400 font-medium",children:[e.jsx("span",{className:"material-icons text-xs mr-1",children:"attach_money"}),"$",s.price]})]}),e.jsx(J,{onClick:()=>t(s),disabled:s.quantity===0,variant:"contained",color:"primary",className:"w-full !py-2",children:s.quantity===0?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"material-icons mr-2 text-sm",children:"block"}),"Out of Stock"]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"material-icons mr-2 text-sm",children:"add_shopping_cart"}),"Add to Cart"]})})]},s.id))}),e.jsx(K,{currentPage:i.currentPage,totalItems:i.totalItems,itemsPerPage:i.itemsPerPage,onPageChange:A,onItemsPerPageChange:D}),m.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("span",{className:"material-icons text-4xl text-gray-400 dark:text-gray-500",children:"inbox"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-2",children:"No items found"})]})]})]}),e.jsx("div",{className:"order-1 xl:order-2",children:e.jsx(V,{cart:a,addToCart:t,removeFromCart:I,clearCart:q,users:L,onCheckout:()=>{console.log("Checkout completed")}})})]})};export{te as default};
